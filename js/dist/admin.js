(()=>{var t={n:n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return t.d(o,{a:o}),o},d:(n,o)=>{for(var e in o)t.o(o,e)&&!t.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:o[e]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};(()=>{"use strict";t.r(n);const o=flarum.core.compat["admin/app"];var e=t.n(o);const a=flarum.core.compat["common/components/Button"];var r=t.n(a);function l(t,n){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},l(t,n)}const i=flarum.core.compat["common/components/Modal"];var s=t.n(i);const c=flarum.core.compat["common/components/Switch"];var u=t.n(c);const d=flarum.core.compat["common/components/LoadingIndicator"];var p=t.n(d);const y=flarum.core.compat["common/utils/extractText"];var h=t.n(y),f=function(t){var n,o;function a(){for(var n,o=arguments.length,e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];return(n=t.call.apply(t,[this].concat(e))||this).amount="",n.notify=!1,n.message="",n.suspended=!1,n.lastActivity="",n.previewCount=null,n}o=t,(n=a).prototype=Object.create(o.prototype),n.prototype.constructor=n,l(n,o);var i=a.prototype;return i.className=function(){return"Modal--small"},i.title=function(){return e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.title")},i.oncreate=function(n){t.prototype.oncreate.call(this,n),this.refresh()},i.content=function(){var t=this;return m(".Modal-body",[m(".Form-group",[m("label",e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.amount")),m("input.FormControl",{type:"number",value:this.amount,onchange:function(n){t.amount=n.target.value},min:0,step:.1,disabled:this.loading})]),e().forum.attribute("moneyRewardsCreateMoney")?m(".Form-group",[u().component({state:this.notify,onchange:function(n){t.notify=n},disabled:this.loading},e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.notify"))]):null,m(".Form-group",[m("label",e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.message")),m("textarea.FormControl",{disabled:!this.notify||this.loading,value:this.notify?this.message:"",onchange:function(n){t.message=n.target.value},placeholder:this.notify?"":h()(e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.messagePlaceholder"))}),m(".helpText",e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.messageHelp"))]),e().forum.attribute("moneyRewardsCreateMoney")?m(".Form-group",[u().component({state:this.suspended,onchange:function(n){t.suspended=n,t.refresh()},disabled:this.loading},e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.suspended"))]):null,m(".Form-group",[m("label",e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.lastActivity")),m("input.FormControl",{type:"date",value:this.lastActivity,onchange:function(n){t.lastActivity=n.target.value,t.refresh()},disabled:this.loading})]),m(".Form-group",[m("p",e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.preview",{count:null===this.previewCount?p().component({display:"inline",size:"small"}):this.previewCount}))]),m(".Form-group",r().component({type:"submit",className:"Button Button--primary",loading:this.loading,disabled:parseFloat(this.amount||"0")<=0},e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.submit")))])},i.refresh=function(){var t=this;this.previewCount=null,this.request(!0).then((function(n){t.previewCount=n.userMatchCount,m.redraw()}))},i.request=function(t){return void 0===t&&(t=!1),e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/money-to-all",errorHandler:this.onerror.bind(this),body:{suspended:this.suspended,lastActivity:this.lastActivity,amount:this.amount,notify:this.notify,message:this.message,dryRun:t}})},i.onsubmit=function(t){var n=this;t.preventDefault(),this.loading=!0,this.request().then((function(t){n.hide(),e().alerts.show({type:"success"},e().translator.trans("clarkwinkelmann-money-to-all.lib.modal.success",{count:t.userMatchCount}))})).catch((function(){n.loading=!1,m.redraw()}))},a}(s());e().initializers.add("clarkwinkelmann-money-to-all",(function(){e().extensionData.for("clarkwinkelmann-money-to-all").registerSetting((function(){return m(".Form-group",r().component({className:"Button",onclick:function(){e().modal.show(f)}},e().translator.trans("clarkwinkelmann-money-to-all.admin.settings.send")))}))}))})(),module.exports=n})();
//# sourceMappingURL=admin.js.map